<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>TabletopでGoogleスプレッドシート読み込み</title>
  <script src="https://unpkg.com/tabletop@1.6.4/tabletop.js"></script>
</head>
<body>
  <h1>サンプルスプレッドシートのA1セルの値：</h1>
  <div id="output">読み込み中...</div>

  <script>
    // これはGoogle公式のサンプルシート
    const publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/pubhtml';

    function showInfo(data, tabletop) {
      // 1行目（index 0）の "Student Name" 列の値を表示
      const output = document.getElementById('output');
      if (data && data.length > 0 && data[0]["Student Name"]) {
        output.textContent = data[0]["Student Name"];
      } else {
        output.textContent = "値が見つかりません";
      }
    }

    window.addEventListener('DOMContentLoaded', function () {
      Tabletop.init({
        key: publicSpreadsheetUrl,
        callback: showInfo,
        simpleSheet: true
      });
    });
  </script>
</body>
</html>
